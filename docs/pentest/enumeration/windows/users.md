```
nxc smb <TARGET_IP> -u 'guest' -p '' --rid-brute
nxc smb 10.10.191.87 -u 'guest' -p '' --rid-brute

impacket-lookupsid anonymous:@<TARGET_IP> | cut -d " " -f 2 > usernames.txt
impacket-lookupsid anonymous:@10.10.191.87 | cut -d " " -f 2 > usernames.txt

rpcclient $> querydispinfo
rpcclient $> enumdomusers

enum4linux -a -u "" -p "" <IP> && enum4linux -a -u "guest" -p "" <IP>
```
Current Logged-in User (Local)
```
whoami /all
whoami /priv
whoami /groups
```
Local User Accounts
```
net user
Get-LocalUser
Get-ADUser -Filter 'Name -like "*<PATTERN>*"' -Server <DOMAIN_CONTROLLER> | Format-Table Name, SamAccountName -AutoSize
```

Specific Local User Details
```
net user <USERNAME>
Get-ADUser -Identity <USERNAME> -Server <DOMAIN_CONTROLLER> -Properties *
```

Domain User Accounts
```
net user /domain
Get-NetUser
Get-NetUser | select cn, pwdlastset, lastlogon
```
Domain Accounts with SPNs
```
Get-NetUser -SPN | select samaccountname,serviceprincipalname
```
SPN Users
```
setspn -L <SERVICE_ACCOUNT>       # Enumerate SPNs for a specific user account
setspn -Q */*                     # Query all SPNs in the domain (often maps to service accounts)
```