## Simple Network Management Protocol (SNMP)

SCAN
```
161/udp   open|filtered snmp
```
Note: `open|filtered` may still respond!

Community String Brute-Force 
```
onesixtyone "$IP" -c /usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt
onesixtyone 10.10.221.173 -c /usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt

hydra -P /usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt -f "$IP" snmp
```
Community String with Metasploit 
```
msfconsole -q
msf6 > use scanner/snmp/snmp_login
msf6 auxiliary(scanner/snmp/snmp_login) > run
[!] No active DB -- Credential data will not be saved!
[+] 10.10.221.173:161 - Login Successful: openview (Access level: read-only); Proof (sysDescr.0): Hardware: Intel64 Family 6 Model 79 Stepping 1 AT/AT COMPATIBLE - Software: Windows Version 6.3 (Build 17763 Multiprocessor Free)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```

Management Information Base (MIB) Query
```
snmpwalk -c <COMMUNITY> -v<1/2c/3> "$IP"
snmpwalk -c public -v1 -t 10 192.168.50.151


snmp-check -c <COMMUNITY> "$IP"
snmp-check -c openview "$IP"
```

Specified MIB Query
```
snmpwalk -c <COMMUNITY> <VERSION> "$IP" <Object Identifier>
snmpwalk -c openview -v1 10.10.221.173 1.3.6.1.4.1.77.1.2.25 
```

### OID: NET-SNMP-EXTEND-MIB
```
snmpwalk <VERSION> -c <COMMUNITY> "$IP" NET-SNMP-EXTEND-MIB::nsExtendObjects
snmpwalk -v2c -c public 192.168.150.149 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
Reference:  
- [Abusing Linux SNMP for RCE](https://mogwailabs.de/en/blog/2019/10/abusing-linux-snmp-for-rce/)  
- [SNMP Arbitrary Command Execution and Shell](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)

### Common OIDs for SNMP Enumeration

| **Enumeration Task**                      | **OID**                    | **Description**                                           |
| ----------------------------------------- | -------------------------- | --------------------------------------------------------- |
| **System Information**                    | `1.3.6.1.2.1.1`            | General system info (hostname, uptime, description, etc.) |
| **Running Processes**                     | `1.3.6.1.2.1.25.4.2.1.2`   | Lists currently running processes                         |
| **Installed Software**                    | `1.3.6.1.2.1.25.6.3.1.2`   | Enumerates installed applications                         |
| **Open TCP Ports**                        | `1.3.6.1.2.1.6.13.1.3`     | Lists listening TCP ports                                 |
| **Open UDP Ports**                        | `1.3.6.1.2.1.6.13.1.2`     | Lists listening UDP ports                                 |
| **User Accounts**                         | `1.3.6.1.4.1.77.1.2.25`    | Retrieves local user accounts                             |
| **Network Interfaces**                    | `1.3.6.1.2.1.2.2.1.2`      | Lists network interfaces on the device                    |
| **ARP Table**                             | `1.3.6.1.2.1.4.22.1.2`     | Retrieves ARP cache (IP-MAC mappings)                     |
| **Routing Table**                         | `1.3.6.1.2.1.4.21.1`       | Retrieves routing table entries                           |
| **Uptime**                                | `1.3.6.1.2.1.1.3.0`        | System uptime in ticks                                    |
| **Hostname**                              | `1.3.6.1.2.1.1.5.0`        | Retrieves system hostname                                 |
| **Windows Services (if SNMP is enabled)** | `1.3.6.1.4.1.77.1.2.3.1.1` | Lists running Windows services                            |
