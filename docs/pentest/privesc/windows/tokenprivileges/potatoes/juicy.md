## **Background information**
Juicy Potato is a variant of the RottenPotatoNG exploit that was developed to bypass situations where the **BITS service is disabled** or **port 6666 is in use**, preventing the original RottenPotato attack from working. It still targets privilege escalation on Windows systems, but instead of relying solely on BITS, it leverages **other COM servers** that can be exploited to escalate privileges.

Requirements for the exploit to work:  
1. **Instantiable COM server** by the current user (typically a "service user" with impersonation privileges).  
2. The server must implement the **IMarshal interface**.  
3. The server runs as an elevated user (e.g., **SYSTEM** or **Administrator**).

JuicyPotato allows you to:  
- Target CLSID: Pick any CLSID you want, with a list organized by OS.  
- COM Listening Port: Define the COM listening port instead of the default 6666.  
- COM Listening IP Address: Bind the server to any IP address.  
- Process Creation Mode:  

    - CreateProcessWithToken (requires SeImpersonate privilege)  
    - CreateProcessAsUser (requires SeAssignPrimaryToken privilege)  
    - Both options are available.  
- Process to Launch: Specify an executable or script to launch if exploitation succeeds.
- Process Argument: Customize the arguments for the launched process.
- RPC Server Address: Authenticate to an external RPC server for stealth.
- RPC Server Port: Use a different port if port 135 is blocked by a firewall.
- Test Mode: Test CLSIDs by creating the DCOM object and printing the user token for verification.
## How it works? 
The core concept is similar to that of the RottenPotato exploit but extends it by targeting additional COM services and allowing more flexible configuration options.

## How to ?

Upload a `.bat` file (Reverse shell code) on Windows Target

Run Juicy potato executable
```
.\JuicyPotato.exe -t * -p <.bat FILE> 
```