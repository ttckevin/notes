High level overview  
1. Trick the “NT AUTHORITY\SYSTEM” account into authenticating via NTLM to a TCP endpoint we control.  
2. Man-in-the-middle this authentication attempt (NTLM relay) to locally negotiate a security token for the “NT AUTHORITY\SYSTEM” account. This is done through a series of Windows API calls.  
3. Impersonate the token we have just negotiated. This can only be done if the attackers current account has the privilege to impersonate security tokens. This is usually true of most service accounts and not true of most user-level accounts.
#### How does it work?
1. API call to `CoGetInstanceFromIStorage` to fetch an instance of the BITS object that is loaded on `127.0.0.1:6666`
2. Packet Relay: Attacker's listener will relay packets receive from COM to the RPC server on port 135 (Until NTLM authentication happens)
3. Local Authentication: 
- COM is going to try to initiate NTLM authentication with us by sending the NTLM Type 1 (Negotiate) message
- Relay NTLM Type 1 (Negotiate) message to RPC (on TCP 135)
- RPC will reply with an NTLM Type 2 (Challenge) message
- Forward the modified NTLM Type 2(Negotiate) packet to COM where the “Challenge” and “Reserved” fields match the output from `AcceptSecurityContext`
- COM on behalf of the SYSTEM account will send us back the NTLM Type 3 (Authenticate) packet
1. Call `ImpersonateSecurityContext` with the result of the final call above to get an impersonation token.